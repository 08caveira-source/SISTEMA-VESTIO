<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Principal - Vestio</title>
    <link rel="shortcut icon" href="#">
    <link rel="stylesheet" href="../css/globais.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script type="module" src="../js/auth-guard.js"></script>
    <style>
        .badge { padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: bold; color: white; }
        .bg-pendente { background-color: #e67e22; }
        .bg-pago { background-color: #27ae60; }
        .bg-quitado { background-color: #2c3e50; }
    </style>
</head>
<body style="margin: 0; background-color: #020617;">

    <nav class="menu-lateral">
        <h3 class="titulo-menu">Principal</h3>
        <a href="dashboard.html" class="menu-link ativo"><span class="menu-icone">üè†</span> In√≠cio</a>
        
        <a href="#" onclick="window.open('pdv.html', 'CaixaPDV', 'width=' + screen.width + ',height=' + screen.height + ',fullscreen=yes,menubar=no,toolbar=no,location=no'); return false;" class="menu-link" style="background: rgba(48, 209, 88, 0.1); color: #30D158; border: 1px dashed #30D158;">
            <span class="menu-icone">üõí</span> Abrir Caixa (PDV)
        </a>
        
        <h3 class="titulo-menu">Gest√£o</h3>
        <a href="estoque.html" class="menu-link"><span class="menu-icone">üì¶</span> Estoque</a>
        <a href="clientes.html" class="menu-link"><span class="menu-icone">üë•</span> Clientes</a>
        <a href="relatorios.html" class="menu-link"><span class="menu-icone">üìä</span> Relat√≥rios</a>
        
        <h3 class="titulo-menu">Integra√ß√µes</h3>
        <a href="online.html" class="menu-link"><span class="menu-icone">üåê</span> Pedidos Online</a>
        
        <h3 class="titulo-menu">Configura√ß√µes</h3>
        <a href="config.html" class="menu-link"><span class="menu-icone">‚öôÔ∏è</span> Configura√ß√µes Gerais</a>
    </nav>

    <header>
        <h1>Painel Principal</h1>
        <div style="display: flex; align-items: center; gap: 15px;">
            <span id="nome-utilizador">Ol√°, Usu√°rio</span>
            <button id="btn-logout" style="background: linear-gradient(135deg, #FF453A, #c41e15) !important; width: auto; padding: 0 20px;">SAIR</button>
        </div>
    </header>

    <main>
        <div style="display: flex; gap: 20px; align-items: flex-start;">
            
            <div style="flex: 3; display: flex; flex-direction: column; gap: 25px;">
                
                <div>
                    <h2 style="margin-bottom: 5px;">Resumo de Hoje</h2>
                    <p style="color: #94a3b8; margin-top: 0;">Vis√£o geral do desempenho di√°rio.</p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div class="card-metrica" style="border-left: 5px solid #27ae60;">
                        <h3 style="color: #94a3b8;">Vendas Hoje</h3>
                        <p id="card-vendas-hoje" style="font-size: 32px; font-weight: bold; margin: 10px 0;">R$ 0,00</p>
                        <button onclick="window.location.href='relatorios.html'" style="width:100%; background:rgba(39, 174, 96, 0.2); color:#27ae60; border:none; padding:8px; border-radius:4px; cursor:pointer;">Ver Detalhes ‚ûî</button>
                    </div>
                    
                    <div class="card-metrica" style="border-left: 5px solid #e67e22;">
                        <h3 style="color: #94a3b8;">Credi√°rio a Receber</h3>
                        <p id="card-crediario-pendente" style="font-size: 32px; font-weight: bold; margin: 10px 0;">R$ 0,00</p>
                    </div>

                    <div class="card-metrica" style="border-left: 5px solid #3498db;">
                        <h3 style="color: #94a3b8;">Valor em Estoque</h3>
                        <p id="card-valor-estoque" style="font-size: 32px; font-weight: bold; margin: 10px 0;">R$ 0,00</p>
                    </div>
                    
                    <div class="card-metrica" style="border-left: 5px solid #9b59b6;">
                        <h3 style="color: #94a3b8;">Pedidos Online</h3>
                        <p id="card-online-pendente" style="font-size: 32px; font-weight: bold; margin: 10px 0;">0</p>
                        <small style="color: #9b59b6; font-weight: bold;" id="status-online">Nenhum pedido novo</small>
                    </div>
                </div>

                <div class="tabela-container">
                    <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px; margin-bottom: 15px;">
                        <h3 style="margin: 0;">√öltimas Vendas do Dia</h3>
                        <small style="color: #94a3b8;">Atualizado em tempo real</small>
                    </div>
                    
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th>HORA</th>
                                <th>CLIENTE</th>
                                <th>TOTAL</th>
                                <th>PGTO</th>
                                <th>STATUS</th>
                                <th>A√á√ÉO</th>
                            </tr>
                        </thead>
                        <tbody id="tabela-vendas-hoje">
                            <tr><td colspan="7" style="padding: 30px; text-align: center; color: #94a3b8;">Carregando vendas...</td></tr>
                        </tbody>
                    </table>

                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1);">
                        <button id="btn-ant" style="padding: 5px 10px; cursor: pointer; background: rgba(255,255,255,0.1); border: none; border-radius: 4px; font-size: 12px; color: white;">‚ùÆ Anterior</button>
                        <span id="info-paginacao" style="font-size: 12px; color: #94a3b8;">P√°gina 1</span>
                        <button id="btn-prox" style="padding: 5px 10px; cursor: pointer; background: rgba(255,255,255,0.1); border: none; border-radius: 4px; font-size: 12px; color: white;">Pr√≥ximo ‚ùØ</button>
                    </div>
                </div>

            </div>
            
            <div style="flex: 1; max-width: 350px;">
                <div class="card-metrica" style="border-top: 5px solid #e74c3c;">
                    <h3 style="margin-top: 0; color: #ff6b6b; display: flex; align-items: center; gap: 10px; font-size: 16px;">
                        ‚ö†Ô∏è √öltimas Pe√ßas
                    </h3>
                    <p style="font-size: 12px; color: #94a3b8; margin-bottom: 15px;">Itens com 3 unidades ou menos no estoque.</p>
                    <div style="max-height: 500px; overflow-y: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                            <tbody id="lista-alerta-estoque">
                                <tr><td style="padding: 15px; text-align: center; color: #94a3b8;">Verificando...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </main>

    <div id="modal-detalhes" class="modal-overlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:2000; justify-content:center; align-items:center;">
        <div class="modal-content" style="width: 400px; padding: 20px; display: flex; flex-direction: column; gap: 10px;">
            <div style="display:flex; justify-content:space-between; align-items: center;">
                <h3 style="margin: 0;">Detalhes da Venda</h3>
            </div>
            <p style="margin: 10px 0 0 0;">Vendedor: <b id="detalhe-vendedor"></b></p>
            <p style="margin: 0;">Cliente: <b id="detalhe-cliente"></b></p>
            <div style="background:rgba(0,0,0,0.3); padding:10px; max-height:200px; overflow-y:auto; border-radius: 8px;">
                <table style="width:100%; font-size: 13px;"><tbody id="lista-itens-venda"></tbody></table>
            </div>
            <h2 style="text-align:right; color:#27ae60; margin: 10px 0;">Total: <span id="detalhe-total"></span></h2>
            
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button id="btn-segunda-via" class="btn-verde" style="flex: 1; padding: 0 10px;">‚úÖ Confirmar 2¬™ Via</button>
                <button onclick="document.getElementById('modal-detalhes').style.display='none'" class="btn-vermelho" style="flex: 1; padding: 0 10px;">‚ùå Rejeitar / Fechar</button>
            </div>
        </div>
    </div>

    <script type="module" src="../js/dashboard.js"></script>
</body>
</html>